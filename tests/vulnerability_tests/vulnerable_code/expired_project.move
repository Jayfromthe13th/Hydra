module game::leaderboard {
    use sui::object::{Self, ID, UID};
    use sui::balance::{Self, Balance};
    use sui::coin::{Self, Coin};
    use sui::clock::Clock;

    public fun create_project<T>(
        project_manager: &mut ProjectManager,
        leaderboard: &mut Leaderboard<T>,
        deposit: Coin<T>,
        ctx: &mut TxContext,
    ): ProjectOwnerCap<T> {
        let leaderboard_id = object::id(leaderboard);

        // BUG: Missing timestamp validation
        // Should check: clock::timestamp_ms(clock) < leaderboard.end_timestamp_ms

        let project = Project<T> {
            id: object::new(ctx),
            balance: coin::into_balance(deposit),
            leaderboard_id,
        };

        let project_id = object::id(&project);
        bag::add(&mut project_manager.projects, project_id, project);

        ProjectOwnerCap<T> {
            id: object::new(ctx),
            project_id,
        }
    }
} 