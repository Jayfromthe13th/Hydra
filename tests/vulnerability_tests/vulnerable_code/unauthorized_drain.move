module game::leaderboard {
    use sui::object::{Self, ID};
    use sui::balance::{Self, Balance};
    use sui::coin::{Self, Coin};
    use sui::transfer;
    use sui::tx_context::TxContext;

    // BUG: Creator can drain any project's funds
    public fun check_out_project<T>(
        project_manager: &mut ProjectManager,
        leaderboard: &Leaderboard<T>,
        project_id: ID,
        ctx: &mut TxContext
    ) {
        let project = bag::borrow_mut<ID, Project<T>>(
            &mut project_manager.projects,
            project_id
        );
        let project_balance_value = balance::value(&project.balance);
        let withdrawed_balance = balance::split(
            &mut project.balance,
            project_balance_value
        );
        let withdrawed_coin = coin::from_balance(withdrawed_balance, ctx);
        // BUG: Sends funds directly to creator without authorization
        transfer::public_transfer(
            withdrawed_coin,
            leaderboard.creator
        );
    }
} 